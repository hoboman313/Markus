<div id="standby_highlighting" >
  Standby - Highlighting...
</div>
<pre id="code" name="code" class="brush: <%=h(@code_type)%>" cols="80" rows="50">
<% # The "h" before the filetext allows us to escape HTML/Javascript strings %>
<%=h file_contents %>
</pre>


<script type="text/javascript">
//<![CDATA[

    // taken from: http://alexgorbatchev.com/SyntaxHighlighter/manual/api/autoloader.html
    function path()
    {
      var args = arguments,
          result = []
          ;
           
      for(var i = 0; i < args.length; i++)
          result.push(args[i].replace('@', '/javascripts/syntaxhighlighter/'));
           
      return result
    };
     
    SyntaxHighlighter.autoloader.apply(null, path(
      'applescript            @shBrushAppleScript.js',
      'actionscript3 as3      @shBrushAS3.js',
      'bash shell             @shBrushBash.js',
      'coldfusion cf          @shBrushColdFusion.js',
      'cpp c                  @shBrushCpp.js',
      'c# c-sharp csharp      @shBrushCSharp.js',
      'css                    @shBrushCss.js',
      'delphi pascal          @shBrushDelphi.js',
      'diff patch pas         @shBrushDiff.js',
      'erl erlang             @shBrushErlang.js',
      'groovy                 @shBrushGroovy.js',
      'java                   @shBrushJava.js',
      'jfx javafx             @shBrushJavaFX.js',
      'js jscript javascript  @shBrushJScript.js',
      'perl pl                @shBrushPerl.js',
      'php                    @shBrushPhp.js',
      'text plain             @shBrushPlain.js',
      'py python              @shBrushPython.js',
      'ruby rails ror rb      @shBrushRuby.js',
      'sass scss              @shBrushSass.js',
      'scala                  @shBrushScala.js',
      'scheme                 @shBrushScheme.js',
      'scilab                 @shBrushScilab.js',
      'sql                    @shBrushSql.js',
      'vb vbnet               @shBrushVb.js',
      'xml xhtml xslt html    @shBrushXml.js'
    ));
    
    // these will later be used to add on to the toolbar in the SyntaxHighlighter3p0Adapter.js
    SyntaxHighlighter.config.strings.BoostCode = "+A"
    SyntaxHighlighter.config.strings.ShrinkCode = "-A"
    
    SyntaxHighlighter.all();
    
    $('standby_highlighting').hide();
    if ($('annotation_menu') != null){
      $('annotation_menu').show();
    }
    source_code_ready();

    <% if (defined? annots) %>
        <% annots.each do |annot| %>
            add_annotation_text(<%=annot.annotation_text.id%>,
            '<%=simple_format(h(escape_javascript(annot.annotation_text.content.to_s)))%>');
            add_annotation(<%=annot.id%>, $R(<%= annot.line_start %>, <%= annot.line_end %>),
             '<%=annot.annotation_text.id%>');

        <% end %>
    <% end %>


    <% if !@focus_line.nil? %>
      focus_source_code_line(<%=@focus_line%>);
    <% end %>
//]]>
</script>

